webpackJsonp([9],{712:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(10),u=a(s);n(43),n(42);var c=n(838),p=a(c),f=n(979),d=a(f);n(941);var h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={remarkTxt:n.props.location.query.remarkTxt||sessionStorage.getItem("currentApprovalText")||"",textarea2:"",type:"readonly",allSearchArg:n.props.location.query,guid:n.props.location.query.dataKey},n.AppState={text:"",approval:[]},n.currentApproval={list:[],comment:""},n}return l(t,e),i(t,[{key:"EVENT_CHANGE_TEXTAREA",value:function(e){var t=this,n=e.target.value,a=t.state.allSearchArg;n.length>1e3&&(n=n.slice(0,1e3)),a.remarkTxt=n,t.setState({remarkTxt:n,allSearchArg:a}),sessionStorage.setItem("currentApprovalText",n)}},{key:"render",value:function(){var e=this;return u.default.createElement("section",{className:"ProcessApproval"},u.default.createElement(p.default,{allSearchArg:e.state.allSearchArg,current:"ProcessApproval"}),u.default.createElement("h3",{className:"boxGroupTit"},u.default.createElement("p",null,u.default.createElement("span",null,"审批流程"))),u.default.createElement("article",null,u.default.createElement("table",{className:"table PATextarea",width:"100%"},u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("th",null,"备注"),u.default.createElement("td",null,u.default.createElement("textarea",{value:this.state.remarkTxt,onChange:this.EVENT_CHANGE_TEXTAREA.bind(this),placeholder:"请输入备注内容"}))))),u.default.createElement("div",{className:"mgT10"},u.default.createElement(d.default,{AppState:this.AppState,guid:this.state.guid,data:this.state.remarkTxt,allSearchArg:this.state.allSearchArg}))))}}]),t}(u.default.Component);t.default=h},838:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(10),s=function(e){return e&&e.__esModule?e:{default:e}}(i);n(43),n(42);var u=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={TapList:[],allSearchArg:n.props.allSearchArg},n}return o(t,e),l(t,[{key:"getQueryTab",value:function(){var e=this,t=e.props.allSearchArg.current,n=[{id:""+t,url:"/"+t},{id:"newProjectApproval",url:"/newProjectApproval"},{id:"newProjectStage",url:"/newProjectStage"}];switch(e.state.allSearchArg.e){case iss.getEVal("newProjectStatus"):this.setState({TapList:[n[0],n[1]]});break;case iss.getEVal("intallmentStatus"):this.setState({TapList:[n[0],n[2]]})}}},{key:"setTapList",value:function(){var e=this;return this.state.TapList.map(function(t,n){var a="";switch(t.id){case"ProcessApproval":case"ProcessApprover":a="流程审批";break;case"newProjectApproval":a="项目信息";break;case"newProjectStage":a="分期信息"}return s.default.createElement("li",{className:e.props.current==t.id?"active":"",key:n,onClick:e.EVENT_CLICK_LINK.bind(e,t.url,t.id)},a)})}},{key:"EVENT_CLICK_LINK",value:function(e,t,n){var a=this,r=a.state.allSearchArg,o=[];for(var l in r)o.push(l+"="+r[l]);iss.hashHistory.push({pathname:e,search:"?"+o.join("&")})}},{key:"componentWillMount",value:function(){this.getQueryTab()}},{key:"render",value:function(){return s.default.createElement("section",null,s.default.createElement("header",{className:"JH-HeadTab"},s.default.createElement("ul",{className:"JH-HeadList"},this.setTapList())))}}]),t}(s.default.Component);t.default=u},938:function(e,t,n){var a=n(939);"string"==typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(305)(a,r);a.locals&&(e.exports=a.locals)},939:function(e,t,n){t=e.exports=n(304)(void 0),t.push([e.i,"h1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: lighter;\n}\ntextarea,\ntextarea:hover {\n  outline: none;\n}\n.boxGroupDetail {\n  padding: 0 0px;\n  font-size: 1rem;\n}\n.boxGroupDetail .textareaText {\n  width: 100%;\n  height: 80px;\n  padding: 10px;\n  resize: none;\n  border: 1px solid #dddddd;\n}\n.boxGroupDetail .boxGroupTitBig {\n  height: 40px;\n  line-height: 40px;\n  background: #0b4082;\n  color: #ffffff ;\n  padding: 0 20px 0 40px;\n  background-image: url("+n(940)+');\n  background-repeat: no-repeat;\n  background-position: 15px;\n}\n.boxGroupDetail .formTable2 tr td {\n  width: 202px;\n}\n.boxGroupDetail .formTable2 tr td:nth-of-type(1) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable2 tr td:nth-of-type(3) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable2 tr td:nth-of-type(5) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable1 tr td {\n  width: 202px;\n}\n.boxGroupDetail .formTable1 tr td:nth-of-type(1) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable1 tr td:nth-of-type(3) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable1 tr td:nth-of-type(5) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable3 tr:nth-of-type(1) th {\n  background: #f5f5f5;\n  text-align: center;\n}\n.boxGroupDetail .formTable3 tr td:nth-of-type(1) {\n  background: #f5f5f5;\n  text-align: right;\n}\n.boxGroupDetail .formTable3 tr td .inputTextBox {\n  width: 100%;\n}\n.boxGroupDetail .formTableLabel {\n  width: 100%;\n  text-align: right;\n}\n.boxGroupDetail table > tbody > tr > td,\n.boxGroupDetail .table > tbody > tr > th,\n.boxGroupDetail .table > tfoot > tr > td,\n.boxGroupDetail .table > tfoot > tr > th,\n.boxGroupDetail .table > thead > tr > td,\n.boxGroupDetail .table > thead > tr > th {\n  padding: 2px !important;\n  border: 1px solid #dddddd;\n}\n.boxGroupDetail .tableProject {\n  margin-top: 20px;\n}\n.boxGroupDetail .btnBox {\n  text-align: center;\n  height: 40px;\n  line-height: 40px;\n}\n.boxGroupDetail .btnBox a {\n  display: inline-block;\n  padding: 0 12px;\n  height: 26px;\n  line-height: 26px;\n  background: #0b4082;\n  color: #ffffff ;\n  margin: 0 10px;\n}\n.boxGroupDetail .btnBox a:hover {\n  background: #f1a118;\n}\n.boxGroupDetail .approvalProcess tr th {\n  text-align: center;\n  background: #f5f5f5;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(1) {\n  width: 150px;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(3) {\n  width: 150px;\n  text-align: center;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(4) {\n  width: 150px;\n  text-align: center;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(5) {\n  width: 150px;\n  text-align: center;\n}\n.ApplyFlow li {\n  display: inline-block;\n  margin: 0 3px;\n  cursor: pointer;\n}\n.ApplyFlow li::after {\n  display: inline-block;\n  content: "->";\n  margin-left: 3px;\n}\n.ApplyFlow li:last-child::after {\n  display: none;\n}\n.ApplyFlow li label {\n  font-weight: normal;\n}\n',""])},940:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAuUlEQVQ4T+2TXQ3CQBCE53MADnAADkBCJVQCEooDJFQCEiqhOKiEOhiyTSFtc3AlvLLJPd3Otz83h34MpnrbzRe8HiheANtnSUdJ1wzkDvRRDDgNANutpDhdRryRVEg6SLpNAQPNdhW8JQS42C6BesyJUasU4JTqAGhsH4D2HaAfR1izw52kMtnBGvXHEf4Akk+43Mu4xL2k7cyJQLgrG7bD6h0wWP5p5VpSUMMPuYjKr2Kz35hTpu4fyuOCEY3r4pUAAAAASUVORK5CYII="},941:function(e,t,n){var a=n(942);"string"==typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(305)(a,r);a.locals&&(e.exports=a.locals)},942:function(e,t,n){t=e.exports=n(304)(void 0),t.push([e.i,"textarea:-moz-placeholder {\n  color: #999;\n}\ntextarea::-webkit-input-placeholder {\n  color: #999;\n}\ntextarea:-ms-input-placeholder {\n  color: #999;\n}\n.ProcessApproval .PATextarea th,\n.ProcessApproval .PATextarea td {\n  border: #ddd solid 1px;\n  padding: 10px;\n}\n.ProcessApproval .PATextarea th {\n  width: 150px;\n  text-align: left;\n  vertical-align: middle;\n  font-size: 14px;\n  font-weight: normal;\n  background: #f5f5f5;\n}\n.ProcessApproval .PATextarea td textarea {\n  width: 100%;\n  resize: none;\n  height: 80px;\n  border: #ddd solid 1px;\n  padding: 3px;\n}\n",""])},979:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(10),s=function(e){return e&&e.__esModule?e:{default:e}}(i);n(43),n(42),n(938);var u=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={aOpinions:"审核意见",aList:[],InfoData:[],allSearchArg:n.props.allSearchArg,history:[]},n.type="edit",n.selectedFlows=[],n.currentApprovalList=sessionStorage.getItem("currentApprovalList")?JSON.parse(sessionStorage.getItem("currentApprovalList")):[],n}return o(t,e),l(t,[{key:"componentWillMount",value:function(){this.props.callback&&this.props.callback(this),this.GetAjax()}},{key:"changeAOinions",value:function(e){this.setState({aOpinions:e.target.value})}},{key:"GetAjax",value:function(){var e=this,t=e.state.allSearchArg,n={entiId:t.e,dataKey:t.dataKey,userId:iss.userInfo.ID,comanyId:t.areaId,comanyName:t.areaName};iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/GetSubmitWorkflows",type:"POST",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(n),success:function(t){e.setState({InfoData:JSON.parse(t.d.Data)})},error:function(e){}});iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/GetFlowLog",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(n),success:function(t){t.d.Data&&e.setState({history:JSON.parse(t.d.Data).Rows})}})}},{key:"EVENT_CHANGE_LIST",value:function(e,t){for(var n=(this.state.InfoData[0].Flows,t.target.value),a=0;a<this.selectedFlows.length;a++)this.selectedFlows[a].ContextGuid==e.Id&&(this.selectedFlows[a].Participants=n);sessionStorage.setItem("currentApprovalList",JSON.stringify(this.selectedFlows))}},{key:"EVENT_CHANGE_CHECKBOX",value:function(e,t){var n=t.target;this.selectedFlows.forEach(function(t,a){if(t.ContextGuid!=e.Id);else{var r=t.Participants.join(",");if(n.checked)r.indexOf(n.value)<0&&t.Participants.push(n.value);else{var o=new RegExp(n.value+",*","ig"),l=r.replace(o,"").replace(/\,$/gi,"");t.Participants=l.length<=0?[]:l.split(",")}}}),sessionStorage.setItem("currentApprovalList",JSON.stringify(this.selectedFlows))}},{key:"evConfirmSubmitTo",value:function(){var e=this;iss.checkLogin(function(t){iss.evConfirmAlert("是否确认提交",e.EVENT_CLICK_SUBMIT.bind(e))})}},{key:"EVENT_CLICK_SUBMIT",value:function(){this.BIND_CHECKED()}},{key:"BIND_CHECKED",value:function(){var e=this,t=e.state.allSearchArg,n={runtimeUnique:{EntiId:t.e,DataKey:t.dataKey}};iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/IsSubmitted",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(t){"false"==t.d.Data&&1==t.d.Success?e.BIND_CHECKEDSUCESS():(iss.popover({content:t.d.Message}),$(window).trigger("treeLoad"))}})}},{key:"BIND_CHECKEDSUCESS",value:function(){var e=this,t=e.state.allSearchArg,n={DataKey:t.dataKey,EntiId:t.e,EventUserId:iss.userInfo.ID,Files:[],ProcessComment:this.props.data||""},a=this.selectedFlows.map(function(e,t){return"string"==typeof e.Participants&&(e.Participants=[e.Participants.toString()]),e}),r=JSON.stringify({submitData:n,selectedFlows:a});iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/SubmitWorkflow",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:r,success:function(e){var t=e.d;1==t.Success?(iss.popover({content:"提交成功！",type:2}),sessionStorage.removeItem("currentApprovalText"),sessionStorage.removeItem("currentApprovalList"),$(window).trigger("treeLoad"),iss.hashHistory.push({pathname:"agenty"})):iss.popover({content:t.Message})}})}},{key:"setInfoDataList",value:function(){var e=this,t=this;if(t.state.InfoData.length){var n=t.state.InfoData[0].Flows;return t.selectedFlows=t.currentApprovalList.length?t.currentApprovalList:[],n.map(function(n,a){var r={ContextGuid:n.Id,FlowName:n.Text,FlowType:n.Type,FlowType2:n.FlowType2,ParentContextGuid:n.PId,Participants:[],RunFlowId:"0"},o=[];!t.currentApprovalList.length&&t.selectedFlows.push(r);var l=e.currentApprovalList.length?e.currentApprovalList[a].Participants:"";if("Approve"==n.Type&&"edit"==t.type&&n.Users.length>=2){var i=n.Users.filter(function(e,t){return e});return s.default.createElement("li",{key:a},s.default.createElement("span",null,n.Text),s.default.createElement("select",{ref:"select",defaultValue:l,onChange:t.EVENT_CHANGE_LIST.bind(t,n)},i.map(function(e,t){return 0==t&&(o.push(e.UId),r.Participants=o),s.default.createElement("option",{key:t,value:e.UId},e.Name)})))}if("AutoInform"==n.Type&&"edit"==t.type){var u=n.Users.filter(function(e,t){return e});return l="string"!=typeof l?l.join(","):"",s.default.createElement("li",{key:a},s.default.createElement("span",null,n.Text,"【",u.map(function(e,a){return o.push(e.UId),r.Participants=o,s.default.createElement("label",{key:a},s.default.createElement("input",{key:a,type:"checkbox",defaultChecked:l?_d.indexOf(e.UId)>=0:"true",value:e.UId,onChange:t.EVENT_CHANGE_CHECKBOX.bind(t,n)}),e.Name+(a==n.Users.length-1?"":","))}),"】"))}var c=n.Users.filter(function(e,t){return e}),p=c.map(function(e,t){for(var a=0;a<o.length;a++);return o.push(e.UId),e.Name+(t==n.Users.length-1?"":",")});return r.Participants=o,s.default.createElement("li",{key:a},s.default.createElement("span",null,n.Text),s.default.createElement("span",null,"【",p,"】"))},this)}}},{key:"EVENT_CLICK_PASS",value:function(){}},{key:"Event_click_cancel",value:function(){var e="";switch(this.props.allSearchArg.e){case iss.getEVal("intallmentStatus"):e="intallment";break;case iss.getEVal("newProjectStatus"):e="newProject"}sessionStorage.removeItem("currentApprovalText"),sessionStorage.removeItem("currentApprovalList"),iss.hashHistory.replace({pathname:"/"+e,search:"?status=edit&dataKey="+this.props.allSearchArg.dataKey+"&e="+this.props.allSearchArg.e})}},{key:"BIND_CHECKEDIT",value:function(){return"edit"!=this.type?s.default.createElement("p",{className:"btnBox"},s.default.createElement("a",{className:"btn",href:"javascript:;",onClick:this.EVENT_CLICK_PASS.bind(this)},"通过"),s.default.createElement("a",{className:"btn",href:"javascript:;"},"驳回")):s.default.createElement("p",{className:"btnBox"},s.default.createElement("a",{className:"btn",href:"javascript:;","data-disable":"false",onClick:this.evConfirmSubmitTo.bind(this)},"提交"),s.default.createElement("a",{className:"btn",href:"javascript:;",onClick:this.Event_click_cancel.bind(this)},"取消"))}},{key:"BIND_HISTORY",value:function(){return this.state.history.map(function(e,t){return s.default.createElement("tr",{key:t},s.default.createElement("td",null,e.FLOWNAME),s.default.createElement("td",null,e.PROCESSCOMMENT),s.default.createElement("td",null,e.EVENTUSERNAME),s.default.createElement("td",null,e.EVENTDATE),s.default.createElement("td",null,e.TRACKINGEVENTTEXT))})}},{key:"render",value:function(){var e=this.state.aOpinions;return s.default.createElement("div",{className:"boxGroupDetail"},s.default.createElement("table",{className:"table tableProject"},s.default.createElement("tbody",null,s.default.createElement("tr",null,s.default.createElement("td",{width:"100"},"审批流程"),s.default.createElement("td",null,s.default.createElement("ul",{className:"ApplyFlow"},s.default.createElement("li",{className:"Running"},"发起人【",iss.userInfo.empName,"】"),this.setInfoDataList()))),"edit"!=this.type&&s.default.createElement("tr",null,s.default.createElement("td",null),s.default.createElement("td",null,s.default.createElement("textarea",{className:"textareaText",value:e,onChange:this.changeAOinions.bind(this)}))))),this.BIND_CHECKEDIT(),s.default.createElement("table",{className:"table tableProject approvalProcess"},s.default.createElement("tbody",null,s.default.createElement("tr",null,s.default.createElement("th",null,"节点"),s.default.createElement("th",null,"意见"),s.default.createElement("th",null,"操作人"),s.default.createElement("th",null,"操作时间"),s.default.createElement("th",null,"操作")),this.BIND_HISTORY())))}}]),t}(s.default.Component);t.default=u}});