webpackJsonp([23],{1006:function(e,t,n){var a=n(1007);"string"==typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(305)(a,r);a.locals&&(e.exports=a.locals)},1007:function(e,t,n){t=e.exports=n(304)(void 0),t.push([e.i,".peripheral {\n  position: relative;\n  top: 0;\n  left: 0;\n  color: #5b5b5b;\n  padding: 10px;\n}\n.peripheral .peripheralList ul {\n  height: 40px;\n  position: relative;\n  top: 0;\n  left: 0;\n  z-index: 11;\n}\n.peripheral .peripheralList ul li {\n  position: relative;\n  color: #fff;\n  display: inline-block;\n  height: 40px;\n  cursor: pointer;\n  line-height: 40px;\n  border-left: none;\n  padding-left: 25px;\n  background: #337ab7;\n  border-bottom-color: transparent;\n}\n.peripheral .peripheralList ul li.active {\n  height: 40px;\n  background: skyblue;\n  font-size: 14px;\n}\n.peripheral .peripheralList ul li.active:after {\n  border-color: transparent transparent transparent skyblue;\n}\n.peripheral .peripheralList ul li:before {\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 0;\n  height: 0;\n  border: 20px solid #fff;\n  border-color: transparent transparent transparent #fff ;\n}\n.peripheral .peripheralList ul li:after {\n  content: '';\n  position: absolute;\n  right: -40px;\n  top: 0;\n  width: 0;\n  height: 0;\n  border: 20px solid #337ab7;\n  border-color: transparent transparent transparent #337ab7;\n  z-index: 9;\n}\n.peripheral .peripheralList .peripheralBox {\n  position: relative;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  border: #ccc solid 1px;\n  padding: 10px;\n  min-height: 300px;\n  background: #fdfdfd;\n}\n.peripheral .peripheralList .peripheralBox table tr td {\n  color: #5b5b5b;\n  padding: 5px 4.8px;\n  position: relative;\n  border: #ccc solid 1px;\n}\n.peripheral .peripheralList .peripheralBox table tr td:nth-child(1),\n.peripheral .peripheralList .peripheralBox table tr td:nth-child(2) {\n  border-right: none;\n}\n.peripheral .peripheralList .peripheralBox table tr td textarea {\n  width: 100%;\n  outline: none;\n  border: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 44px;\n}\n",""])},730:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(10),s=function(e){return e&&e.__esModule?e:{default:e}}(l);n(43),n(42),n(1006);var c=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={listData:[],current:[]},n.dataKey="",n.id="",n.dataBaseInfo=[],n.dataGetInfo=[],window.iframeCallback=n.iframeCallback.bind(n),n}return i(t,e),o(t,[{key:"componentWillMount",value:function(){this.dataKey=this.props.location.query.dataKey,this.id=this.props.location.query.currentID,this.GET_ExternalAjaxFirst()}},{key:"iframeCallback",value:function(e,t){var n=this,a=n.state.listData;a.forEach(function(e,t){e.LandId||(e.LandId=n.id),e.FieldList.forEach(function(e,t){delete e.regExp})});var r=JSON.stringify([{LandId:n.id,ExternalData:a}]);iss.ajax({type:"POST",url:"/Project/ISaveExternal",dataType:"JSON",data:{projectId:n.dataKey,externalInfoJson:r},success:function(e){top.iss.popover({content:"保存成功",type:2}),t.modal("hide")},error:function(e){top.iss.popover({content:"保存失败",type:1}),t.modal("hide")}})}},{key:"CHECK_APPRAL",value:function(){var e=this,t=this.dataGetInfo.filter(function(t,n){if(t.LandId==e.id)return t});if(t.length)this.setState({listData:t[0].ExternalData,current:t[0].ExternalData[0],activeID:t[0].ExternalData[0].QuotaGroup});else{var n=JSON.parse(e.dataBaseInfo);this.dataGetInfo.push({LandId:e.id,ExternalData:n}),this.setState({listData:n,current:n[0],activeID:n[0].QuotaGroup})}}},{key:"GET_ExternalAjaxFirst",value:function(){var e=this,t=this.dataKey,n=top.sessionStorage.getItem("$$dataKey-"+t+"-static");n&&(e.dataBaseInfo=top.sessionStorage.getItem("$$dataKey-"+t+"-static"));var a=new Promise(function(a,r){if(n)return void a();iss.ajax({url:"/Project/INewLandExternalInfo",data:{projectId:t},success:function(n){var r=n.rows?JSON.stringify(n.rows):"";e.dataBaseInfo=r.replace(/"LandId"\:""/gi,'"LandId":"'+e.id+'"'),top.sessionStorage.setItem("$$dataKey-"+t+"-static",r),a()},error:function(){r()}})}),r=new Promise(function(n,a){iss.ajax({url:"/Project/ILandsExternalInfo",data:{projectId:t},success:function(t){t.rows&&t.rows.length&&(e.dataGetInfo=t.rows),n()},error:function(){a()}})});Promise.all([a,r]).then(function(t){e.CHECK_APPRAL()},function(e){console.log(e)})}},{key:"EVENT_CLICK_UPDATE",value:function(e){var t="../../Project/IGetAttachmentsByItemId";new Promise(function(n,a){iss.ajax({url:t,data:{itemId:e.valueId},success:function(e){e&&e.rows&&n(e.rows),n("")},error:function(e){a()}})}).then(function(n){top.iss.upload({server:"../../Project/UpLoadFile",content:n,fileVal:"FileData",formData:{fileId:e.valueId},onReady:function(e){},onUploadSucess:function(n,a,r){iss.ajax({url:t,data:{itemId:e.valueId},success:function(e){a(e.rows||[])},error:function(e){}})},onRemove:function(e,t){iss.ajax({url:"../../Project/IDeleteAttachment",data:{attachmentId:t},success:function(t){e.remove()},error:function(e){console.log(e)}})}})})}},{key:"EVENT_CHANGE_TEXTAREA",value:function(e,t){this.state.current.FieldList.forEach(function(n,a){if(n.valueId==e.valueId)return void(n.val=t.target.value)}),this.setState({current:this.state.current})}},{key:"EVENT_CLICK_TAP",value:function(e,t){this.setState({current:e,activeID:e.QuotaGroup})}},{key:"Bind_data_tap",value:function(){var e=this;return this.state.listData.map(function(t,n){return s.default.createElement("li",{key:n,className:t.QuotaGroup==e.state.activeID?"active":"",onClick:e.EVENT_CLICK_TAP.bind(e,t)},t.QuotaName)})}},{key:"Bind_List_Peripher",value:function(){var e=this,t=(this.id,this.state.current);if(t&&t.FieldList&&t.FieldList.length)return t.FieldList.map(function(t,n){return s.default.createElement("tr",{key:n},s.default.createElement("td",{className:"right",width:"300"},t.label),s.default.createElement("td",{className:"left"},"TEXTAREA"==t.type.toString().toLocaleUpperCase()?s.default.createElement("textarea",{value:t.val||"",onChange:e.EVENT_CHANGE_TEXTAREA.bind(e,t),readOnly:t.edit.indexOf("+r")>=0}):s.default.createElement("input",{type:"text",onChange:e.EVENT_CHANGE_TEXTAREA.bind(e,t),readOnly:t.edit.indexOf("+r")>=0})),s.default.createElement("td",{className:"center",width:"80"},s.default.createElement("button",{className:"btn btn-primary",onClick:e.EVENT_CLICK_UPDATE.bind(e,t)},"上传")))})}},{key:"render",value:function(){return s.default.createElement("article",{className:"peripheral"},s.default.createElement("div",{className:"peripheralList"},s.default.createElement("ul",null,this.Bind_data_tap()),s.default.createElement("div",{className:"peripheralBox"},s.default.createElement("table",{className:"row",width:"100%"},s.default.createElement("tbody",null,this.Bind_List_Peripher())))))}}]),t}(s.default.Component);t.default=c}});