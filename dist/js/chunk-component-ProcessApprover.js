webpackJsonp([8],{713:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(10),c=a(s);n(43),n(42);var u=n(838),p=a(u),f=n(980),d=a(f);n(941);var h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={remarkTxt:"",type:"readonly",allSearchArg:n.props.location.query,guid:n.props.location.query.dataKey},n}return l(t,e),i(t,[{key:"evSetRemarkTxt",value:function(e){var t=this,n=t.state.allSearchArg;n.remarkTxt=e,t.setState({allSearchArg:n})}},{key:"render",value:function(){var e=this;return c.default.createElement("section",{className:"ProcessApproval"},c.default.createElement(p.default,{id:e.props.location.query.e,current:"ProcessApprover",allSearchArg:e.state.allSearchArg}),c.default.createElement("h3",{className:"boxGroupTit"},c.default.createElement("p",null,c.default.createElement("span",null,"审批流程"))),c.default.createElement("article",null,c.default.createElement("div",{className:"mgT10"},c.default.createElement(d.default,{guid:e.state.guid,allSearchArg:e.state.allSearchArg,callback:e.evSetRemarkTxt.bind(e)}))))}}]),t}(c.default.Component);t.default=h},838:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(10),s=function(e){return e&&e.__esModule?e:{default:e}}(i);n(43),n(42);var c=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={TapList:[],allSearchArg:n.props.allSearchArg},n}return o(t,e),l(t,[{key:"getQueryTab",value:function(){var e=this,t=e.props.allSearchArg.current,n=[{id:""+t,url:"/"+t},{id:"newProjectApproval",url:"/newProjectApproval"},{id:"newProjectStage",url:"/newProjectStage"}];switch(e.state.allSearchArg.e){case iss.getEVal("newProjectStatus"):this.setState({TapList:[n[0],n[1]]});break;case iss.getEVal("intallmentStatus"):this.setState({TapList:[n[0],n[2]]})}}},{key:"setTapList",value:function(){var e=this;return this.state.TapList.map(function(t,n){var a="";switch(t.id){case"ProcessApproval":case"ProcessApprover":a="流程审批";break;case"newProjectApproval":a="项目信息";break;case"newProjectStage":a="分期信息"}return s.default.createElement("li",{className:e.props.current==t.id?"active":"",key:n,onClick:e.EVENT_CLICK_LINK.bind(e,t.url,t.id)},a)})}},{key:"EVENT_CLICK_LINK",value:function(e,t,n){var a=this,r=a.state.allSearchArg,o=[];for(var l in r)o.push(l+"="+r[l]);iss.hashHistory.push({pathname:e,search:"?"+o.join("&")})}},{key:"componentWillMount",value:function(){this.getQueryTab()}},{key:"render",value:function(){return s.default.createElement("section",null,s.default.createElement("header",{className:"JH-HeadTab"},s.default.createElement("ul",{className:"JH-HeadList"},this.setTapList())))}}]),t}(s.default.Component);t.default=c},938:function(e,t,n){var a=n(939);"string"==typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(305)(a,r);a.locals&&(e.exports=a.locals)},939:function(e,t,n){t=e.exports=n(304)(void 0),t.push([e.i,"h1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: lighter;\n}\ntextarea,\ntextarea:hover {\n  outline: none;\n}\n.boxGroupDetail {\n  padding: 0 0px;\n  font-size: 1rem;\n}\n.boxGroupDetail .textareaText {\n  width: 100%;\n  height: 80px;\n  padding: 10px;\n  resize: none;\n  border: 1px solid #dddddd;\n}\n.boxGroupDetail .boxGroupTitBig {\n  height: 40px;\n  line-height: 40px;\n  background: #0b4082;\n  color: #ffffff ;\n  padding: 0 20px 0 40px;\n  background-image: url("+n(940)+');\n  background-repeat: no-repeat;\n  background-position: 15px;\n}\n.boxGroupDetail .formTable2 tr td {\n  width: 202px;\n}\n.boxGroupDetail .formTable2 tr td:nth-of-type(1) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable2 tr td:nth-of-type(3) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable2 tr td:nth-of-type(5) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable1 tr td {\n  width: 202px;\n}\n.boxGroupDetail .formTable1 tr td:nth-of-type(1) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable1 tr td:nth-of-type(3) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable1 tr td:nth-of-type(5) {\n  background: #f5f5f5;\n  width: 160px;\n}\n.boxGroupDetail .formTable3 tr:nth-of-type(1) th {\n  background: #f5f5f5;\n  text-align: center;\n}\n.boxGroupDetail .formTable3 tr td:nth-of-type(1) {\n  background: #f5f5f5;\n  text-align: right;\n}\n.boxGroupDetail .formTable3 tr td .inputTextBox {\n  width: 100%;\n}\n.boxGroupDetail .formTableLabel {\n  width: 100%;\n  text-align: right;\n}\n.boxGroupDetail table > tbody > tr > td,\n.boxGroupDetail .table > tbody > tr > th,\n.boxGroupDetail .table > tfoot > tr > td,\n.boxGroupDetail .table > tfoot > tr > th,\n.boxGroupDetail .table > thead > tr > td,\n.boxGroupDetail .table > thead > tr > th {\n  padding: 2px !important;\n  border: 1px solid #dddddd;\n}\n.boxGroupDetail .tableProject {\n  margin-top: 20px;\n}\n.boxGroupDetail .btnBox {\n  text-align: center;\n  height: 40px;\n  line-height: 40px;\n}\n.boxGroupDetail .btnBox a {\n  display: inline-block;\n  padding: 0 12px;\n  height: 26px;\n  line-height: 26px;\n  background: #0b4082;\n  color: #ffffff ;\n  margin: 0 10px;\n}\n.boxGroupDetail .btnBox a:hover {\n  background: #f1a118;\n}\n.boxGroupDetail .approvalProcess tr th {\n  text-align: center;\n  background: #f5f5f5;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(1) {\n  width: 150px;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(3) {\n  width: 150px;\n  text-align: center;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(4) {\n  width: 150px;\n  text-align: center;\n}\n.boxGroupDetail .approvalProcess tr td:nth-of-type(5) {\n  width: 150px;\n  text-align: center;\n}\n.ApplyFlow li {\n  display: inline-block;\n  margin: 0 3px;\n  cursor: pointer;\n}\n.ApplyFlow li::after {\n  display: inline-block;\n  content: "->";\n  margin-left: 3px;\n}\n.ApplyFlow li:last-child::after {\n  display: none;\n}\n.ApplyFlow li label {\n  font-weight: normal;\n}\n',""])},940:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAuUlEQVQ4T+2TXQ3CQBCE53MADnAADkBCJVQCEooDJFQCEiqhOKiEOhiyTSFtc3AlvLLJPd3Otz83h34MpnrbzRe8HiheANtnSUdJ1wzkDvRRDDgNANutpDhdRryRVEg6SLpNAQPNdhW8JQS42C6BesyJUasU4JTqAGhsH4D2HaAfR1izw52kMtnBGvXHEf4Akk+43Mu4xL2k7cyJQLgrG7bD6h0wWP5p5VpSUMMPuYjKr2Kz35hTpu4fyuOCEY3r4pUAAAAASUVORK5CYII="},941:function(e,t,n){var a=n(942);"string"==typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(305)(a,r);a.locals&&(e.exports=a.locals)},942:function(e,t,n){t=e.exports=n(304)(void 0),t.push([e.i,"textarea:-moz-placeholder {\n  color: #999;\n}\ntextarea::-webkit-input-placeholder {\n  color: #999;\n}\ntextarea:-ms-input-placeholder {\n  color: #999;\n}\n.ProcessApproval .PATextarea th,\n.ProcessApproval .PATextarea td {\n  border: #ddd solid 1px;\n  padding: 10px;\n}\n.ProcessApproval .PATextarea th {\n  width: 150px;\n  text-align: left;\n  vertical-align: middle;\n  font-size: 14px;\n  font-weight: normal;\n  background: #f5f5f5;\n}\n.ProcessApproval .PATextarea td textarea {\n  width: 100%;\n  resize: none;\n  height: 80px;\n  border: #ddd solid 1px;\n  padding: 3px;\n}\n",""])},980:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),_react=__webpack_require__(10),_react2=_interopRequireDefault(_react);__webpack_require__(43),__webpack_require__(42),__webpack_require__(938);var ApprovalControlNode2=function(_React$Component){function ApprovalControlNode2(e){_classCallCheck(this,ApprovalControlNode2);var t=_possibleConstructorReturn(this,(ApprovalControlNode2.__proto__||Object.getPrototypeOf(ApprovalControlNode2)).call(this,e));return t.state={aOpinions:t.props.allSearchArg.remarkTxt||"",type:!1,InfoData:[],mainData:"",history:[],fromArg:t.props.allSearchArg.from||""},t.getInfo={entiId:t.props.allSearchArg.e,dataKey:t.props.allSearchArg.dataKey,checkedUserId:"",currentRuntFlowId:"",backToRuntFlowId:"0",eventUserId:"",userId:"",delegateUserId:"0",comment:"",files:[]},t.selectedFlows=[],t}return _inherits(ApprovalControlNode2,_React$Component),_createClass(ApprovalControlNode2,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=setInterval(function(n){iss.userInfo&&(e.getInfo.userId=e.getInfo.eventUserId=iss.userInfo.ID,e.getInfo.checkedUserId=iss.userInfo.ID,e.GetJurisdiction(function(t){var n=t.d;n.Success?(e.setState({type:!0,mainData:n.Data}),e.GetAjax()):e.setState({type:!1})})),clearInterval(t)},1e3)}},{key:"changeAOinions",value:function(e){var t=this,n=this,a=e.target.value;a.length>1e3&&(a=a.slice(0,1e3)),n.props.callback(a),this.setState({aOpinions:a},function(e){n.getInfo.comment=t.state.aOpinions})}},{key:"GetJurisdiction",value:function(e){var t=this.getInfo;iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/GetUserRights",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),success:function(t){e&&e(t)}})}},{key:"GetAjax",value:function(){var e=this;iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/LoadNodes",type:"POST",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(e.getInfo),success:function(t){var n=t.d;n.forEach(function(t,n){if("Running"==t.FlowStatus)return void(e.getInfo.currentRuntFlowId=t.FlowId)}),e.setState({InfoData:n})},error:function(e){}});iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/GetFlowLog",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(this.getInfo),success:function(t){t.d.Data&&e.setState({history:JSON.parse(t.d.Data).Rows})}})}},{key:"setInfoDataList",value:function(){if(this.state.InfoData.length){return this.state.InfoData.map(function(e,t){return _react2.default.createElement("li",{key:t,className:e.FlowStatus},_react2.default.createElement("span",null,e.FlowName),_react2.default.createElement("span",null,"【",e.Participants,"】"))},this)}}},{key:"evConfirmBackTo",value:function(){var e=this;iss.checkLogin(function(t){iss.evConfirmAlert("是否确认驳回",e.EVENT_CLICK_SUBMIT.bind(e))})}},{key:"EVENT_CLICK_SUBMIT",value:function EVENT_CLICK_SUBMIT(){var serverurl="/iWorkflow/Workflow/api/WFServices.asmx/BackToFlow",dto=this.getInfo,comment=this.getInfo.comment;""==comment&&(dto.comment="驳回"),iss.ajax({url:serverurl,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(dto),success:function(e){var t=e.d;t.Success?(iss.popover({content:"驳回成功！",type:2}),iss.hashHistory.push({pathname:"/agenty"}),$(document).triggerHandler("reloadMyCount")):iss.popover({content:t.Message})},error:function error(result){var err=eval("("+result.responseText+")");alert(err.Message)}})}},{key:"evConfirmRunWork",value:function(){var e=this;iss.checkLogin(function(t){iss.evConfirmAlert("是否确认通过",e.EVENT_CLICK_PASS.bind(e))})}},{key:"EVENT_CLICK_PASS",value:function EVENT_CLICK_PASS(){var dto=this.getInfo,comment=this.getInfo.comment;""==comment&&(dto.comment="通过"),iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/RunWorkflow2",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(dto),success:function(e){var t=e.d;t.Success?(iss.popover({content:"通过成功！",type:2}),iss.hashHistory.push({pathname:"/agenty"}),$(document).triggerHandler("reloadMyCount")):iss.popover({content:t.Message})},error:function error(result){var err=eval("("+result.responseText+")");alert(err.Message)}})}},{key:"evDeleteReaded",value:function(){var e=this,t=e.getInfo,n={entiId:t.entiId,dataKey:t.dataKey,userId:t.userId};iss.ajax({url:"/iWorkflow/Workflow/api/WFServices.asmx/HaveRead",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(e){var t=e.d;t.Success?(iss.popover({content:"操作成功！",type:2}),$(window).trigger("treeLoad"),iss.hashHistory.push({pathname:"/agenty"}),$(document).triggerHandler("reloadMyCount")):iss.popover({content:t.Message})}})}},{key:"BIND_CHECKEDIT",value:function(){var e=this;return"inform"==e.state.fromArg?_react2.default.createElement("p",{className:"btnBox"},_react2.default.createElement("a",{className:"btn",href:"javascript:void(0);",onClick:e.evDeleteReaded.bind(e)},"已阅")):e.state.type?_react2.default.createElement("p",{className:"btnBox"},e.state.mainData.indexOf("Approve")>=0&&_react2.default.createElement("a",{className:"btn",href:"javascript:;",onClick:e.evConfirmRunWork.bind(e)},"通过"),e.state.mainData.indexOf("Return")>=0&&_react2.default.createElement("a",{className:"btn",href:"javascript:;",onClick:e.evConfirmBackTo.bind(e)},"驳回")):void 0}},{key:"BIND_HISTORY",value:function(){return this.state.history.map(function(e,t){return _react2.default.createElement("tr",{key:t},_react2.default.createElement("td",null,e.FLOWNAME),_react2.default.createElement("td",null,e.PROCESSCOMMENT),_react2.default.createElement("td",null,e.EVENTUSERNAME),_react2.default.createElement("td",null,e.EVENTDATE),_react2.default.createElement("td",null,e.TRACKINGEVENTTEXT))})}},{key:"render",value:function(){var e=this.state.aOpinions;return _react2.default.createElement("div",{className:"boxGroupDetail"},_react2.default.createElement("table",{className:"table tableProject"},_react2.default.createElement("tbody",null,_react2.default.createElement("tr",null,_react2.default.createElement("td",{width:"100"},"审批流程"),_react2.default.createElement("td",null,"  ",_react2.default.createElement("ul",{className:"ApplyFlow"},this.setInfoDataList()))),this.state.type&&_react2.default.createElement("tr",null,_react2.default.createElement("td",{width:"100"},"备注"),_react2.default.createElement("td",null,_react2.default.createElement("textarea",{className:"textareaText",value:e,onChange:this.changeAOinions.bind(this),placeholder:"请输入备注内容"}))))),this.BIND_CHECKEDIT(),_react2.default.createElement("table",{className:"table tableProject approvalProcess"},_react2.default.createElement("tbody",null,_react2.default.createElement("tr",null,_react2.default.createElement("th",null,"节点"),_react2.default.createElement("th",null,"意见"),_react2.default.createElement("th",null,"操作人"),_react2.default.createElement("th",null,"操作时间"),_react2.default.createElement("th",null,"操作")),this.BIND_HISTORY())))}}]),ApprovalControlNode2}(_react2.default.Component);exports.default=ApprovalControlNode2}});